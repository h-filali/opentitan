.section .text.start

    /* Zero out w0 */
    bn.xor w0, w0, w0

    /* Init mask */
    bn.addi w7, w0, 1
    bn.or w7, w0, w7 << 32
    bn.subi w7, w7, 1

    /* Set up constants for input/state */
    li x6, 2
    li x5, 3

    li        x2, 29
    la        x3, modulus
    bn.lid    x2, 0(x3)
    bn.wsrw   MOD, w29

    la x10, vec_sub_a
    la x11, vec_sub_b
    la x12, vec_sub_a

    LOOPI 32, 9
        bn.lid x6, 0(x10++)                         /*x6 = x10[i]*/
        bn.lid x5, 0(x11++)                         /*x5 = x11[i]*/

        LOOPI 8, 5
            /* Mask one coefficient to working registers */
            bn.and w4, w2, w7                       /*w4 = w2 & w7*/
            bn.and w5, w3, w7                       /*w5 = w3 & w7*/
            /* Shift out used coefficient */
            bn.rshi w2, w0, w2 >> 32                /*w2 = (w0 || w2) >> 32*/

            bn.subm w4, w4, w5                      /*w4 = w4 - w5 % MOD*/
            bn.rshi w3, w4, w3 >> 32                /*w3 = (w4 || w3) >> 32*/
        
        bn.sid x5, 0(x12++)                         /*x12[i] = x5*/

    ecall

.data
    .globl modulus
    .balign 32
    modulus:
    .word 0x007FE001
    .word 0x00000000
    .word 0x00000000
    .word 0x00000000
    .word 0x00000000
    .word 0x00000000
    .word 0x00000000
    .word 0x00000000

    .globl vec_sub_a
    .balign 256
    vec_sub_a:
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff
    .word 0x000000ff

    .globl vec_sub_b
    .balign 256
    vec_sub_b:
    .word 0x00000002
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000004
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000005
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000001
    .word 0x00000003